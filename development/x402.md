# x402 Payment Support

## Overview

The x402 protocol extends HTTP `402 Payment Required` responses with payment instructions. Client-side wrappers can automatically detect a 402, construct a payment header, and retry the request after signing with a wallet.citeturn0search1turn0search2

## Recommended Client Library

Use `x402-fetch`, which wraps `fetch` and handles 402 responses automatically.citeturn0search1turn0search8

```bash
npm install x402-fetch @coinbase/x402
```

## Wallet Integration (Privy + viem)

Privy wallets expose an EIP-1193 provider via `getEthereumProvider`, which can be passed to `viem` to create a wallet client.citeturn1search0turn1search1

```ts
const provider = await wallet.getEthereumProvider();
const walletClient = createWalletClient({
  account: wallet.address,
  chain: baseSepolia,
  transport: custom(provider),
});
```

## x402 Usage Example

```ts
import { wrapFetchWithPayment } from "x402-fetch";

const fetchWithPayment = wrapFetchWithPayment(fetch, walletClient);
const res = await fetchWithPayment("https://api.example.com/paid");
```

## Notes

- x402 is pay-per-request: each API call can require its own payment.citeturn0search2
- Use a small `maxValue` guard to cap how much a request is allowed to spend.citeturn0search1
